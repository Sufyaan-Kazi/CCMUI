package com.pivotal.fieldengineering.sampledata.webapp;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

import com.pivotal.fieldengineering.sampledata.beans.Contact;
import com.pivotal.fieldengineering.sampledata.beans.Statement;
import com.pivotal.fieldengineering.sampledata.data.AccountDAOImpl;
import com.pivotal.fieldengineering.sampledata.utils.Logger;

//@RestController
public class MainController {
	@Autowired
	private AccountDAOImpl accDao = null;
	
    @RequestMapping("/getStatementsForAcc")
    public Map<Contact, List<Statement>> getStatementsForAcc(@RequestParam(value="accId", required=false, defaultValue="146881") int accId) {
    	Logger.INSTANCE.log("In retrieve statement list from DB for: " + accId);
    	
    	Contact con = accDao.getContactForAccount(accId);
    	//Logger.INSTANCE.log(con.toString());
    	
    	List<Statement>  stmnts = accDao.getStatementsForAccount(accId);
//    	for(Statement stmnt : stmnts){
//    		Logger.INSTANCE.log("\t -> " + stmnt.toString());
//    	}
    	
    	Map<Contact, List<Statement>> accDetails = new HashMap<>(1);
    	accDetails.put(con, stmnts);
    	
    	return accDetails;
        //model.addAttribute("name", accId);
        //return "viewStatementsForAccount";
    }

}